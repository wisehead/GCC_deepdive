#<center>第8章 机器描述文件\${target}.md</center>

机器描述主要包括以下两个部分：
（1）机器描述（Machine Description, MD）文件，即\${target}.md文件，其中\${target}为目标系统名称，主要描述了目标机器所支持的每条指令的指令模板（Instruction Pattern，即Insn Pattern）；
（2）机器描述的头文件及c文件，即${target}.[ch]文件，主要描述了与机器相关的变量声明与函数实现，同时用来配合md文件，实现其指令模板里变量的定义及其函数代码的实现等。

另外，从代码生成的角度看，整个GCC编译器的编译过程主要包括：
（1）编译器前端（Front End）读取源文件，并建立抽象语法树，即完成高级语言源代码到AST/GENERIC的转换；
（2）将与语言相关的AST/GENERIC转换成与语言无关的GIMPLE中间表示，并在此基础上完成各种与目标机器无关的优化；
（3）通过机器描述文件，提取各种具有标准指令模板名称的指令模板，并以这些指令模板为依据，将GIMPLE中间表示转换成RTL语言表示的insn序列，即完成RTL的构造，随后在此基础上，完成各种与目标机器相关的优化；
（4）对于insn序列中的每一个insn，分别和机器描述文件中的指令模板进行匹配，如果匹配成功，则提取该指令模板中的指令输出模板，并以此生成汇编代码。

##8.1 机器描述文件
机器描述就是使用规范的RTL语言对目标机器的特性进行描述。由于目标机器的特性千差万别，尤其是各种机器的指令系统各不相同，为了方便GCC提取目标机器的各种特性，必须使用规范的描述语言RTL（这里是MD-RTL）进行机器描述。

机器描述文件主要包含了表8-1中的内容，主要包括各种指令模板（Insn Pattern）的定义、常量（Constant）定义、属性（Attribute）定义、自定义断言（User-Defined Predicate）、自定义约束（User-DefinedConstraint）、枚举器（Iterator）定义、流水线（Pipeline）声明、窥孔优化（Peephole Optimization）定义等。
![](res/b8-1.png)


